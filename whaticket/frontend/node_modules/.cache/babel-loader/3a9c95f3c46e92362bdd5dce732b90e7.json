{"ast":null,"code":"import { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { has, isArray } from \"lodash\";\nimport { toast } from \"react-toastify\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport toastError from \"../../errors/toastError\";\nimport { socketConnection } from \"../../services/socket\";\n// import { useDate } from \"../../hooks/useDate\";\nimport moment from \"moment\";\nconst useAuth = () => {\n  const history = useHistory();\n  const [isAuth, setIsAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [user, setUser] = useState({});\n  const [socket, setSocket] = useState({});\n  api.interceptors.request.use(config => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      config.headers[\"Authorization\"] = `Bearer ${JSON.parse(token)}`;\n      setIsAuth(true);\n    }\n    return config;\n  }, error => {\n    Promise.reject(error);\n  });\n  api.interceptors.response.use(response => {\n    return response;\n  }, async error => {\n    var _error$response, _error$response2;\n    const originalRequest = error.config;\n    if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 403 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      const {\n        data\n      } = await api.post(\"/auth/refresh_token\");\n      if (data) {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n      }\n      return api(originalRequest);\n    }\n    if ((error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 401) {\n      localStorage.removeItem(\"token\");\n      api.defaults.headers.Authorization = undefined;\n      setIsAuth(false);\n    }\n    return Promise.reject(error);\n  });\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    (async () => {\n      if (token) {\n        try {\n          const {\n            data\n          } = await api.post(\"/auth/refresh_token\");\n          api.defaults.headers.Authorization = `Bearer ${data.token}`;\n          setIsAuth(true);\n          setUser(data.user);\n        } catch (err) {\n          toastError(err);\n        }\n      }\n      setLoading(false);\n    })();\n  }, []);\n  useEffect(() => {\n    if (Object.keys(user).length && user.id > 0) {\n      // console.log(\"Entrou useWhatsapp com user\", Object.keys(user).length, Object.keys(socket).length ,user, socket)\n      let io;\n      if (!Object.keys(socket).length) {\n        io = socketConnection({\n          user\n        });\n        setSocket(io);\n      } else {\n        io = socket;\n      }\n      io.on(`company-${user.companyId}-user`, data => {\n        if (data.action === \"update\" && data.user.id === user.id) {\n          setUser(data.user);\n        }\n      });\n      return () => {\n        // console.log(\"desconectou o company user \", user.id)\n        io.off(`company-${user.companyId}-user`);\n        // io.disconnect();\n      };\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }\n  }, [user]);\n  const handleLogin = async userData => {\n    setLoading(true);\n    try {\n      const {\n        data\n      } = await api.post(\"/auth/login\", userData);\n      const {\n        user: {\n          company\n        }\n      } = data;\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(s => s.key === \"campaignsEnabled\");\n        if (setting && setting.value === \"true\") {\n          localStorage.setItem(\"cshow\", null); //regra pra exibir campanhas\n        }\n      }\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(s => s.key === \"sendSignMessage\");\n        const signEnable = setting.value === \"enable\";\n        if (setting && setting.value === \"enabled\") {\n          localStorage.setItem(\"sendSignMessage\", signEnable); //regra pra exibir campanhas\n        }\n      }\n      localStorage.setItem(\"profileImage\", data.user.profileImage); //regra pra exibir imagem contato\n\n      moment.locale('pt-br');\n      let dueDate;\n      if (data.user.company.id === 1) {\n        dueDate = '2999-12-31T00:00:00.000Z';\n      } else {\n        dueDate = data.user.company.dueDate;\n      }\n      const hoje = moment(moment()).format(\"DD/MM/yyyy\");\n      const vencimento = moment(dueDate).format(\"DD/MM/yyyy\");\n      var diff = moment(dueDate).diff(moment(moment()).format());\n      var before = moment(moment().format()).isBefore(dueDate);\n      var dias = moment.duration(diff).asDays();\n      if (before === true) {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        // localStorage.setItem(\"public-token\", JSON.stringify(data.user.token));\n        // localStorage.setItem(\"companyId\", companyId);\n        // localStorage.setItem(\"userId\", id);\n        localStorage.setItem(\"companyDueDate\", vencimento);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setUser(data.user);\n        setIsAuth(true);\n        toast.success(i18n.t(\"auth.toasts.success\"));\n        if (Math.round(dias) < 5) {\n          toast.warn(`Sua assinatura vence em ${Math.round(dias)} ${Math.round(dias) === 1 ? 'dia' : 'dias'} `);\n        }\n\n        // // Atraso para garantir que o cache foi limpo\n        // setTimeout(() => {\n        //   window.location.reload(true); // Recarregar a página\n        // }, 1000);\n\n        history.push(\"/tickets\");\n        setLoading(false);\n      } else {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        // localStorage.setItem(\"companyId\", companyId);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setUser(data.user);\n        setIsAuth(true);\n        toastError(`Opss! Sua assinatura venceu ${vencimento}.\nEntre em contato com o Suporte para mais informações! `);\n        history.push(\"/financeiro\");\n        setLoading(false);\n      }\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n  const handleLogout = async () => {\n    setLoading(true);\n    try {\n      // socket.disconnect();\n      await api.delete(\"/auth/logout\");\n      setIsAuth(false);\n      setUser({});\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"cshow\");\n      // localStorage.removeItem(\"public-token\");\n      api.defaults.headers.Authorization = undefined;\n      setLoading(false);\n      history.push(\"/login\");\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n  const getCurrentUserInfo = async () => {\n    try {\n      const {\n        data\n      } = await api.get(\"/auth/me\");\n      console.log(data);\n      return data;\n    } catch (_) {\n      return null;\n    }\n  };\n  return {\n    isAuth,\n    user,\n    loading,\n    handleLogin,\n    handleLogout,\n    getCurrentUserInfo,\n    socket\n  };\n};\nexport default useAuth;","map":{"version":3,"names":["useState","useEffect","useContext","useHistory","has","isArray","toast","i18n","api","toastError","socketConnection","moment","useAuth","history","isAuth","setIsAuth","loading","setLoading","user","setUser","socket","setSocket","interceptors","request","use","config","token","localStorage","getItem","headers","JSON","parse","error","Promise","reject","response","_error$response","_error$response2","originalRequest","status","_retry","data","post","setItem","stringify","defaults","Authorization","removeItem","undefined","err","Object","keys","length","id","io","on","companyId","action","off","handleLogin","userData","company","companieSettings","setting","find","s","key","value","signEnable","profileImage","locale","dueDate","hoje","format","vencimento","diff","before","isBefore","dias","duration","asDays","success","t","Math","round","warn","push","handleLogout","delete","getCurrentUserInfo","get","console","log","_"],"sources":["/workspaces/simao/whaticket/frontend/src/hooks/useAuth.js/index.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { has, isArray } from \"lodash\";\n\nimport { toast } from \"react-toastify\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport toastError from \"../../errors/toastError\";\nimport { socketConnection } from \"../../services/socket\";\n// import { useDate } from \"../../hooks/useDate\";\nimport moment from \"moment\";\n\nconst useAuth = () => {\n  const history = useHistory();\n  const [isAuth, setIsAuth] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [user, setUser] = useState({});\n  const [socket, setSocket] = useState({})\n \n\n  api.interceptors.request.use(\n    (config) => {\n      const token = localStorage.getItem(\"token\");\n      if (token) {\n        config.headers[\"Authorization\"] = `Bearer ${JSON.parse(token)}`;\n        setIsAuth(true);\n      }\n      return config;\n    },\n    (error) => {\n      Promise.reject(error);\n    }\n  );\n\n  api.interceptors.response.use(\n    (response) => {\n      return response;\n    },\n    async (error) => {\n      const originalRequest = error.config;\n      if (error?.response?.status === 403 && !originalRequest._retry) {\n        originalRequest._retry = true;\n\n        const { data } = await api.post(\"/auth/refresh_token\");\n        if (data) {\n          localStorage.setItem(\"token\", JSON.stringify(data.token));\n          api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        }\n        return api(originalRequest);\n      }\n      if (error?.response?.status === 401) {\n        localStorage.removeItem(\"token\");\n        api.defaults.headers.Authorization = undefined;\n        setIsAuth(false);\n      }\n      return Promise.reject(error);\n    }\n  );\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    (async () => {\n      if (token) {\n        try {\n          const { data } = await api.post(\"/auth/refresh_token\");\n          api.defaults.headers.Authorization = `Bearer ${data.token}`;\n          setIsAuth(true);\n          setUser(data.user);\n        } catch (err) {\n          toastError(err);\n        }\n      }\n      setLoading(false);\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (Object.keys(user).length && user.id > 0) {\n      // console.log(\"Entrou useWhatsapp com user\", Object.keys(user).length, Object.keys(socket).length ,user, socket)\n      let io;\n      if (!Object.keys(socket).length) {\n        io = socketConnection({ user });\n        setSocket(io)\n      } else {\n        io = socket\n      }\n      io.on(`company-${user.companyId}-user`, (data) => {\n        if (data.action === \"update\" && data.user.id === user.id) {\n          setUser(data.user);\n        }\n      });\n\n      return () => {\n        // console.log(\"desconectou o company user \", user.id)\n        io.off(`company-${user.companyId}-user`);\n        // io.disconnect();\n      };\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }\n  }, [user]);\n\n  const handleLogin = async (userData) => {\n    setLoading(true);\n\n    try {\n      const { data } = await api.post(\"/auth/login\", userData);\n      const {\n        user: { company },\n      } = data;\n\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(\n          (s) => s.key === \"campaignsEnabled\"\n        );\n        if (setting && setting.value === \"true\") {\n          localStorage.setItem(\"cshow\", null); //regra pra exibir campanhas\n        }\n      }\n\n      if (has(company, \"companieSettings\") && isArray(company.companieSettings[0])) {\n        const setting = company.companieSettings[0].find(\n          (s) => s.key === \"sendSignMessage\"\n        );\n\n        const signEnable = setting.value === \"enable\";\n\n        if (setting && setting.value === \"enabled\") {\n          localStorage.setItem(\"sendSignMessage\", signEnable); //regra pra exibir campanhas\n        }\n      }\n      localStorage.setItem(\"profileImage\", data.user.profileImage); //regra pra exibir imagem contato\n\n      moment.locale('pt-br');\n      let dueDate;\n      if (data.user.company.id === 1) {\n        dueDate = '2999-12-31T00:00:00.000Z'\n      } else {\n        dueDate = data.user.company.dueDate;\n      }\n      const hoje = moment(moment()).format(\"DD/MM/yyyy\");\n      const vencimento = moment(dueDate).format(\"DD/MM/yyyy\");\n\n      var diff = moment(dueDate).diff(moment(moment()).format());\n\n      var before = moment(moment().format()).isBefore(dueDate);\n      var dias = moment.duration(diff).asDays();\n\n      if (before === true) {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        // localStorage.setItem(\"public-token\", JSON.stringify(data.user.token));\n        // localStorage.setItem(\"companyId\", companyId);\n        // localStorage.setItem(\"userId\", id);\n        localStorage.setItem(\"companyDueDate\", vencimento);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setUser(data.user);\n        setIsAuth(true);\n        toast.success(i18n.t(\"auth.toasts.success\"));\n        if (Math.round(dias) < 5) {\n          toast.warn(`Sua assinatura vence em ${Math.round(dias)} ${Math.round(dias) === 1 ? 'dia' : 'dias'} `);\n        }\n\n        // // Atraso para garantir que o cache foi limpo\n        // setTimeout(() => {\n        //   window.location.reload(true); // Recarregar a página\n        // }, 1000);\n\n        history.push(\"/tickets\");\n        setLoading(false);\n      } else {\n        localStorage.setItem(\"token\", JSON.stringify(data.token));\n        // localStorage.setItem(\"companyId\", companyId);\n        api.defaults.headers.Authorization = `Bearer ${data.token}`;\n        setUser(data.user);\n        setIsAuth(true);\n        toastError(`Opss! Sua assinatura venceu ${vencimento}.\nEntre em contato com o Suporte para mais informações! `);\n        history.push(\"/financeiro\");\n        setLoading(false);\n      }\n\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = async () => {\n    setLoading(true);\n\n    try {\n      // socket.disconnect();\n      await api.delete(\"/auth/logout\");\n      setIsAuth(false);\n      setUser({});\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"cshow\");\n      // localStorage.removeItem(\"public-token\");\n      api.defaults.headers.Authorization = undefined;\n      setLoading(false);\n      history.push(\"/login\");\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  const getCurrentUserInfo = async () => {\n    try {\n      const { data } = await api.get(\"/auth/me\");\n      console.log(data)\n      return data;\n    } catch (_) {\n      return null;\n    }\n  };\n\n  return {\n    isAuth,\n    user,\n    loading,\n    handleLogin,\n    handleLogout,\n    getCurrentUserInfo,\n    socket\n  };\n};\n\nexport default useAuth;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}