{"ast":null,"code":"var _jsxFileName = \"/workspaces/simao/whaticket/frontend/src/components/NotificationsPopOver/index.js\";\nimport React, { useState, useRef, useEffect, useContext } from \"react\";\nimport { useTheme } from \"@material-ui/core/styles\";\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\n// import { SocketContext } from \"../../context/Socket/SocketContext\";\n\nimport useSound from \"use-sound\";\nimport Popover from \"@material-ui/core/Popover\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Badge from \"@material-ui/core/Badge\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\nimport TicketListItem from \"../TicketListItem\";\nimport useTickets from \"../../hooks/useTickets\";\nimport alertSound from \"../../assets/sound.mp3\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { i18n } from \"../../translate/i18n\";\nimport toastError from \"../../errors/toastError\";\nimport useCompanySettings from \"../../hooks/useSettings/companySettings\";\nimport Favicon from \"react-favicon\";\nimport { getBackendUrl } from \"../../config\";\nimport defaultLogoFavicon from \"../../assets/favicon.ico\";\nimport { TicketsContext } from \"../../context/Tickets/TicketsContext\";\nconst useStyles = makeStyles(theme => ({\n  tabContainer: {\n    overflowY: \"auto\",\n    maxHeight: 350,\n    ...theme.scrollbarStyles\n  },\n  popoverPaper: {\n    width: \"100%\",\n    maxWidth: 350,\n    marginLeft: theme.spacing(2),\n    marginRight: theme.spacing(1),\n    [theme.breakpoints.down(\"sm\")]: {\n      maxWidth: 270\n    }\n  },\n  noShadow: {\n    boxShadow: \"none !important\"\n  }\n}));\nconst NotificationsPopOver = volume => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const history = useHistory();\n  // const socketManager = useContext(SocketContext);\n  const {\n    user,\n    socket\n  } = useContext(AuthContext);\n  const {\n    profile,\n    queues\n  } = user;\n  const ticketIdUrl = +history.location.pathname.split(\"/\")[2];\n  const ticketIdRef = useRef(ticketIdUrl);\n  const anchorEl = useRef();\n  const [isOpen, setIsOpen] = useState(false);\n  const [notifications, setNotifications] = useState([]);\n  const queueIds = queues.map(q => q.id);\n  const {\n    get: getSetting\n  } = useCompanySettings();\n  const {\n    setCurrentTicket,\n    setTabOpen\n  } = useContext(TicketsContext);\n  const [showTicketWithoutQueue, setShowTicketWithoutQueue] = useState(false);\n  const [showNotificationPending, setShowNotificationPending] = useState(false);\n  const [showGroupNotification, setShowGroupNotification] = useState(false);\n  const [, setDesktopNotifications] = useState([]);\n  const {\n    tickets\n  } = useTickets({\n    withUnreadMessages: \"true\"\n    // showAll: showTicketWithoutQueue ? \"true\" : \"false\"\n  });\n  const [play] = useSound(alertSound, volume);\n  const soundAlertRef = useRef();\n  const historyRef = useRef(history);\n  useEffect(() => {\n    const fetchSettings = async () => {\n      try {\n        const setting = await getSetting({\n          \"column\": \"showNotificationPending\"\n        });\n        if (setting.showNotificationPending === true) {\n          setShowNotificationPending(true);\n        }\n        if (user.allTicket === \"enable\") {\n          setShowTicketWithoutQueue(true);\n        }\n        if (user.allowGroup === true) {\n          setShowGroupNotification(true);\n        }\n      } catch (err) {\n        toastError(err);\n      }\n    };\n    fetchSettings();\n  }, [setShowTicketWithoutQueue, setShowNotificationPending]);\n  useEffect(() => {\n    soundAlertRef.current = play;\n    if (!(\"Notification\" in window)) {\n      console.log(\"This browser doesn't support notifications\");\n    } else {\n      Notification.requestPermission();\n    }\n  }, [play]);\n  useEffect(() => {\n    const processNotifications = () => {\n      // if (showTicketWithoutQueue) {\n      setNotifications(tickets);\n      // } else {\n      // \tconst newNotifications = tickets.filter(ticket => ticket.status !== \"pending\");\n\n      // \tsetNotifications(newNotifications);\n      // }\n    };\n    processNotifications();\n  }, [tickets]);\n  useEffect(() => {\n    ticketIdRef.current = ticketIdUrl;\n  }, [ticketIdUrl]);\n  useEffect(() => {\n    const companyId = user.companyId;\n    // const socket = socketManager.GetSocket();\n    if (user.id) {\n      const queueIds = queues.map(q => q.id);\n      const onConnectNotificationsPopover = () => {\n        socket.emit(\"joinNotification\");\n      };\n      const onCompanyTicketNotificationsPopover = data => {\n        if (data.action === \"updateUnread\" || data.action === \"delete\") {\n          setNotifications(prevState => {\n            const ticketIndex = prevState.findIndex(t => t.id === data.ticketId);\n            if (ticketIndex !== -1) {\n              prevState.splice(ticketIndex, 1);\n              return [...prevState];\n            }\n            return prevState;\n          });\n          setDesktopNotifications(prevState => {\n            const notfiticationIndex = prevState.findIndex(n => n.tag === String(data.ticketId));\n            if (notfiticationIndex !== -1) {\n              prevState[notfiticationIndex].close();\n              prevState.splice(notfiticationIndex, 1);\n              return [...prevState];\n            }\n            return prevState;\n          });\n        }\n      };\n      const onCompanyAppMessageNotificationsPopover = data => {\n        var _data$ticket, _data$ticket2, _user$queues, _data$ticket3, _data$ticket4, _data$ticket5, _data$ticket6, _data$ticket6$whatsap;\n        // if (\n        // \tdata.action === \"create\" && !data.message.fromMe &&\n        // \t(\n        // \t\tdata.ticket.status !== 'pending' &&\n        // \t\tdata.ticket.status !== \"lgpd\" &&\n        // \t\tdata.ticket.status !== \"nps\"\t\t\t\t\t\t\n        // \t) &&\n        // \t(!data.message.read || (data.ticket.status === \"pending\" && showTicketWithoutQueue && data.ticket.queueId === null) || (data.ticket.status === \"pending\" && !showTicketWithoutQueue && user?.queues?.some(queue => (queue.id === data.ticket.queueId)))) &&\n        // \t(data.ticket.userId === user?.id || !data.ticket.userId)\n        // ) {\n        // \n\n        if (data.action === \"create\" && !data.message.fromMe && !data.message.read && (((_data$ticket = data.ticket) === null || _data$ticket === void 0 ? void 0 : _data$ticket.userId) === (user === null || user === void 0 ? void 0 : user.id) || !((_data$ticket2 = data.ticket) === null || _data$ticket2 === void 0 ? void 0 : _data$ticket2.userId)) && ((user === null || user === void 0 ? void 0 : (_user$queues = user.queues) === null || _user$queues === void 0 ? void 0 : _user$queues.some(queue => queue.id === data.ticket.queueId)) || !data.ticket.queueId && showTicketWithoutQueue === true) && (![\"pending\", \"lgpd\", \"nps\", \"group\"].includes((_data$ticket3 = data.ticket) === null || _data$ticket3 === void 0 ? void 0 : _data$ticket3.status) || ((_data$ticket4 = data.ticket) === null || _data$ticket4 === void 0 ? void 0 : _data$ticket4.status) === \"pending\" && showNotificationPending === true || ((_data$ticket5 = data.ticket) === null || _data$ticket5 === void 0 ? void 0 : _data$ticket5.status) === \"group\" && ((_data$ticket6 = data.ticket) === null || _data$ticket6 === void 0 ? void 0 : (_data$ticket6$whatsap = _data$ticket6.whatsapp) === null || _data$ticket6$whatsap === void 0 ? void 0 : _data$ticket6$whatsap.groupAsTicket) === \"enabled\" && showGroupNotification === true)) {\n          var _data$ticket7, _data$ticket7$whatsap;\n          setNotifications(prevState => {\n            const ticketIndex = prevState.findIndex(t => t.id === data.ticket.id);\n            if (ticketIndex !== -1) {\n              prevState[ticketIndex] = data.ticket;\n              return [...prevState];\n            }\n            return [data.ticket, ...prevState];\n          });\n          const shouldNotNotificate = data.message.ticketId === ticketIdRef.current && document.visibilityState === \"visible\" || data.ticket.userId && data.ticket.userId !== (user === null || user === void 0 ? void 0 : user.id) || data.ticket.isGroup && ((_data$ticket7 = data.ticket) === null || _data$ticket7 === void 0 ? void 0 : (_data$ticket7$whatsap = _data$ticket7.whatsapp) === null || _data$ticket7$whatsap === void 0 ? void 0 : _data$ticket7$whatsap.groupAsTicket) === \"disabled\" && showGroupNotification === false;\n          if (shouldNotNotificate === true) return;\n          handleNotifications(data);\n        }\n      };\n      socket.on(\"connect\", onConnectNotificationsPopover);\n      socket.on(`company-${companyId}-ticket`, onCompanyTicketNotificationsPopover);\n      socket.on(`company-${companyId}-appMessage`, onCompanyAppMessageNotificationsPopover);\n      return () => {\n        socket.off(\"connect\", onConnectNotificationsPopover);\n        socket.off(`company-${companyId}-ticket`, onCompanyTicketNotificationsPopover);\n        socket.off(`company-${companyId}-appMessage`, onCompanyAppMessageNotificationsPopover);\n      };\n    }\n  }, [user, profile, queues, showTicketWithoutQueue, socket, showNotificationPending, showGroupNotification]);\n  const handleNotifications = data => {\n    const {\n      message,\n      contact,\n      ticket\n    } = data;\n    const options = {\n      body: `${message.body} - ${format(new Date(), \"HH:mm\")}`,\n      icon: contact.urlPicture,\n      tag: ticket.id,\n      renotify: true\n    };\n    const notification = new Notification(`${i18n.t(\"tickets.notification.message\")} ${contact.name}`, options);\n    notification.onclick = e => {\n      e.preventDefault();\n      window.focus();\n      setTabOpen(ticket.status);\n      historyRef.current.push(`/tickets/${ticket.uuid}`);\n      // handleChangeTab(null, ticket.isGroup? \"group\" : \"open\");\n    };\n    setDesktopNotifications(prevState => {\n      const notfiticationIndex = prevState.findIndex(n => n.tag === notification.tag);\n      if (notfiticationIndex !== -1) {\n        prevState[notfiticationIndex] = notification;\n        return [...prevState];\n      }\n      return [notification, ...prevState];\n    });\n    soundAlertRef.current();\n  };\n  const handleClick = () => {\n    setIsOpen(prevState => !prevState);\n  };\n  const handleClickAway = () => {\n    setIsOpen(false);\n  };\n  const NotificationTicket = ({\n    children\n  }) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      onClick: handleClickAway,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 10\n      }\n    }, children);\n  };\n  const browserNotification = () => {\n    const numbers = \"⓿➊➋➌➍➎➏➐➑➒➓⓫⓬⓭⓮⓯⓰⓱⓲⓳⓴\";\n    if (notifications.length > 0) {\n      if (notifications.length < 21) {\n        document.title = numbers.substring(notifications.length, notifications.length + 1) + \" - \" + (theme.appName || \"...\");\n      } else {\n        document.title = \"(\" + notifications.length + \")\" + (theme.appName || \"...\");\n      }\n    } else {\n      document.title = theme.appName || \"...\";\n    }\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Favicon, {\n      animated: true,\n      url: (theme === null || theme === void 0 ? void 0 : theme.appLogoFavicon) ? theme.appLogoFavicon : defaultLogoFavicon,\n      alertCount: notifications.length,\n      iconSize: 195,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 5\n      }\n    }));\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, browserNotification(), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: handleClick,\n    ref: anchorEl,\n    \"aria-label\": \"Open Notifications\",\n    color: \"inherit\",\n    style: {\n      color: \"white\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Badge, {\n    overlap: \"rectangular\",\n    badgeContent: notifications.length,\n    color: \"secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ChatIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 6\n    }\n  }))), /*#__PURE__*/React.createElement(Popover, {\n    disableScrollLock: true,\n    open: isOpen,\n    anchorEl: anchorEl.current,\n    anchorOrigin: {\n      vertical: \"bottom\",\n      horizontal: \"right\"\n    },\n    transformOrigin: {\n      vertical: \"top\",\n      horizontal: \"right\"\n    },\n    classes: {\n      paper: classes.popoverPaper\n    },\n    onClose: handleClickAway,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    dense: true,\n    className: classes.tabContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 5\n    }\n  }, notifications.length === 0 ? /*#__PURE__*/React.createElement(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 8\n    }\n  }, i18n.t(\"notifications.noTickets\"))) : notifications.map(ticket => /*#__PURE__*/React.createElement(NotificationTicket, {\n    key: ticket.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(TicketListItem, {\n    ticket: ticket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 9\n    }\n  }))))));\n};\nexport default NotificationsPopOver;","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","useTheme","useHistory","format","useSound","Popover","IconButton","List","ListItem","ListItemText","makeStyles","Badge","ChatIcon","TicketListItem","useTickets","alertSound","AuthContext","i18n","toastError","useCompanySettings","Favicon","getBackendUrl","defaultLogoFavicon","TicketsContext","useStyles","theme","tabContainer","overflowY","maxHeight","scrollbarStyles","popoverPaper","width","maxWidth","marginLeft","spacing","marginRight","breakpoints","down","noShadow","boxShadow","NotificationsPopOver","volume","classes","history","user","socket","profile","queues","ticketIdUrl","location","pathname","split","ticketIdRef","anchorEl","isOpen","setIsOpen","notifications","setNotifications","queueIds","map","q","id","get","getSetting","setCurrentTicket","setTabOpen","showTicketWithoutQueue","setShowTicketWithoutQueue","showNotificationPending","setShowNotificationPending","showGroupNotification","setShowGroupNotification","setDesktopNotifications","tickets","withUnreadMessages","play","soundAlertRef","historyRef","fetchSettings","setting","allTicket","allowGroup","err","current","window","console","log","Notification","requestPermission","processNotifications","companyId","onConnectNotificationsPopover","emit","onCompanyTicketNotificationsPopover","data","action","prevState","ticketIndex","findIndex","t","ticketId","splice","notfiticationIndex","n","tag","String","close","onCompanyAppMessageNotificationsPopover","_data$ticket","_data$ticket2","_user$queues","_data$ticket3","_data$ticket4","_data$ticket5","_data$ticket6","_data$ticket6$whatsap","message","fromMe","read","ticket","userId","some","queue","queueId","includes","status","whatsapp","groupAsTicket","_data$ticket7","_data$ticket7$whatsap","shouldNotNotificate","document","visibilityState","isGroup","handleNotifications","on","off","contact","options","body","Date","icon","urlPicture","renotify","notification","name","onclick","e","preventDefault","focus","push","uuid","handleClick","handleClickAway","NotificationTicket","children","createElement","onClick","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","browserNotification","numbers","length","title","substring","appName","Fragment","animated","url","appLogoFavicon","alertCount","iconSize","ref","color","style","overlap","badgeContent","disableScrollLock","open","anchorOrigin","vertical","horizontal","transformOrigin","paper","onClose","dense","className","key"],"sources":["/workspaces/simao/whaticket/frontend/src/components/NotificationsPopOver/index.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from \"react\";\nimport { useTheme } from \"@material-ui/core/styles\";\n\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\n// import { SocketContext } from \"../../context/Socket/SocketContext\";\n\nimport useSound from \"use-sound\";\n\nimport Popover from \"@material-ui/core/Popover\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Badge from \"@material-ui/core/Badge\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\n\nimport TicketListItem from \"../TicketListItem\";\nimport useTickets from \"../../hooks/useTickets\";\nimport alertSound from \"../../assets/sound.mp3\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { i18n } from \"../../translate/i18n\";\nimport toastError from \"../../errors/toastError\";\nimport useCompanySettings from \"../../hooks/useSettings/companySettings\";\nimport Favicon from \"react-favicon\";\nimport { getBackendUrl } from \"../../config\";\nimport defaultLogoFavicon from \"../../assets/favicon.ico\";\nimport { TicketsContext } from \"../../context/Tickets/TicketsContext\";\n\nconst useStyles = makeStyles(theme => ({\n\ttabContainer: {\n\t\toverflowY: \"auto\",\n\t\tmaxHeight: 350,\n\t\t...theme.scrollbarStyles,\n\t},\n\tpopoverPaper: {\n\t\twidth: \"100%\",\n\t\tmaxWidth: 350,\n\t\tmarginLeft: theme.spacing(2),\n\t\tmarginRight: theme.spacing(1),\n\t\t[theme.breakpoints.down(\"sm\")]: {\n\t\t\tmaxWidth: 270,\n\t\t},\n\t},\n\tnoShadow: {\n\t\tboxShadow: \"none !important\",\n\t},\n}));\n\nconst NotificationsPopOver = (volume) => {\n\tconst classes = useStyles();\n\tconst theme = useTheme();\n\n\tconst history = useHistory();\n\t// const socketManager = useContext(SocketContext);\n\tconst { user, socket } = useContext(AuthContext);\n\tconst { profile, queues } = user;\n\n\tconst ticketIdUrl = +history.location.pathname.split(\"/\")[2];\n\tconst ticketIdRef = useRef(ticketIdUrl);\n\tconst anchorEl = useRef();\n\tconst [isOpen, setIsOpen] = useState(false);\n\tconst [notifications, setNotifications] = useState([]);\n\tconst queueIds = queues.map((q) => q.id);\n\tconst { get: getSetting } = useCompanySettings();\n    const { setCurrentTicket, setTabOpen } = useContext(TicketsContext);\n\n\tconst [showTicketWithoutQueue, setShowTicketWithoutQueue] = useState(false);\n\tconst [showNotificationPending, setShowNotificationPending] = useState(false);\n\tconst [showGroupNotification, setShowGroupNotification] = useState(false);\n\n\tconst [, setDesktopNotifications] = useState([]);\n\n\tconst { tickets } = useTickets({\n\t\twithUnreadMessages: \"true\"\n\t\t// showAll: showTicketWithoutQueue ? \"true\" : \"false\"\n\t});\n\n\tconst [play] = useSound(alertSound, volume);\n\tconst soundAlertRef = useRef();\n\n\tconst historyRef = useRef(history);\n\n\tuseEffect(() => {\n\t\tconst fetchSettings = async () => {\n\t\t\ttry {\n\t\t\t\tconst setting = await getSetting(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"column\": \"showNotificationPending\"\n\t\t\t\t\t}\n\t\t\t\t);\n\n\n\n\t\t\t\tif (setting.showNotificationPending === true) {\n\t\t\t\t\tsetShowNotificationPending(true);\n\t\t\t\t}\n\n\t\t\t\tif (user.allTicket === \"enable\") {\n\t\t\t\t\tsetShowTicketWithoutQueue(true);\n\t\t\t\t}\n\t\t\t\tif (user.allowGroup === true) {\n\t\t\t\t\tsetShowGroupNotification(true);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\ttoastError(err);\n\t\t\t}\n\t\t}\n\n\t\tfetchSettings();\n\t}, [setShowTicketWithoutQueue, setShowNotificationPending]);\n\n\tuseEffect(() => {\n\t\tsoundAlertRef.current = play;\n\n\t\tif (!(\"Notification\" in window)) {\n\t\t\tconsole.log(\"This browser doesn't support notifications\");\n\t\t} else {\n\t\t\tNotification.requestPermission();\n\t\t}\n\t}, [play]);\n\n\tuseEffect(() => {\n\t\tconst processNotifications = () => {\n\t\t\t// if (showTicketWithoutQueue) {\n\t\t\tsetNotifications(tickets);\n\t\t\t// } else {\n\t\t\t// \tconst newNotifications = tickets.filter(ticket => ticket.status !== \"pending\");\n\n\t\t\t// \tsetNotifications(newNotifications);\n\t\t\t// }\n\t\t}\n\n\t\tprocessNotifications();\n\t}, [tickets]);\n\n\tuseEffect(() => {\n\t\tticketIdRef.current = ticketIdUrl;\n\t}, [ticketIdUrl]);\n\n\tuseEffect(() => {\n\t\tconst companyId = user.companyId;\n\t\t// const socket = socketManager.GetSocket();\n\t\tif (user.id) {\n\t\t\tconst queueIds = queues.map((q) => q.id);\n\n\t\t\tconst onConnectNotificationsPopover = () => {\n\t\t\t\tsocket.emit(\"joinNotification\");\n\t\t\t}\n\n\t\t\tconst onCompanyTicketNotificationsPopover = (data) => {\n\t\t\t\tif (data.action === \"updateUnread\" || data.action === \"delete\") {\n\t\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticketId);\n\t\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\t\tprevState.splice(ticketIndex, 1);\n\t\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn prevState;\n\t\t\t\t\t});\n\n\t\t\t\t\tsetDesktopNotifications(prevState => {\n\t\t\t\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\t\t\t\tn => n.tag === String(data.ticketId)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\t\t\t\tprevState[notfiticationIndex].close();\n\t\t\t\t\t\t\tprevState.splice(notfiticationIndex, 1);\n\t\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn prevState;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst onCompanyAppMessageNotificationsPopover = (data) => {\n\t\t\t\t// if (\n\t\t\t\t// \tdata.action === \"create\" && !data.message.fromMe &&\n\t\t\t\t// \t(\n\t\t\t\t// \t\tdata.ticket.status !== 'pending' &&\n\t\t\t\t// \t\tdata.ticket.status !== \"lgpd\" &&\n\t\t\t\t// \t\tdata.ticket.status !== \"nps\"\t\t\t\t\t\t\n\t\t\t\t// \t) &&\n\t\t\t\t// \t(!data.message.read || (data.ticket.status === \"pending\" && showTicketWithoutQueue && data.ticket.queueId === null) || (data.ticket.status === \"pending\" && !showTicketWithoutQueue && user?.queues?.some(queue => (queue.id === data.ticket.queueId)))) &&\n\t\t\t\t// \t(data.ticket.userId === user?.id || !data.ticket.userId)\n\t\t\t\t// ) {\n\t\t\t\t// \n\t\t\t\t\n\t\t\t\tif (\n\t\t\t\t\tdata.action === \"create\" && !data.message.fromMe &&\n\t\t\t\t\t!data.message.read &&\n\t\t\t\t\t(data.ticket?.userId === user?.id || !data.ticket?.userId) &&\n\t\t\t\t\t(user?.queues?.some(queue => (queue.id === data.ticket.queueId)) ||\n\t\t\t\t\t\t!data.ticket.queueId && showTicketWithoutQueue === true) &&\n\t\t\t\t\t(![\"pending\", \"lgpd\", \"nps\", \"group\"].includes(data.ticket?.status) ||\n\t\t\t\t\t\t(data.ticket?.status === \"pending\" && showNotificationPending === true) ||\n\t\t\t\t\t\t(data.ticket?.status === \"group\" && data.ticket?.whatsapp?.groupAsTicket === \"enabled\" && showGroupNotification === true))\n\t\t\t\t) {\n\t\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticket.id);\n\t\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\t\tprevState[ticketIndex] = data.ticket;\n\t\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn [data.ticket, ...prevState];\n\t\t\t\t\t});\n\n\t\t\t\t\tconst shouldNotNotificate =\n\t\t\t\t\t\t(data.message.ticketId === ticketIdRef.current &&\n\t\t\t\t\t\t\tdocument.visibilityState === \"visible\") ||\n\t\t\t\t\t\t(data.ticket.userId && data.ticket.userId !== user?.id) ||\n\t\t\t\t\t\t(data.ticket.isGroup && data.ticket?.whatsapp?.groupAsTicket === \"disabled\" && showGroupNotification === false);\n\n\n\t\t\t\t\tif (shouldNotNotificate === true) return;\n\n\t\t\t\t\thandleNotifications(data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsocket.on(\"connect\", onConnectNotificationsPopover);\n\t\t\tsocket.on(`company-${companyId}-ticket`, onCompanyTicketNotificationsPopover);\n\t\t\tsocket.on(`company-${companyId}-appMessage`, onCompanyAppMessageNotificationsPopover);\n\n\t\t\treturn () => {\n\t\t\t\tsocket.off(\"connect\", onConnectNotificationsPopover);\n\t\t\t\tsocket.off(`company-${companyId}-ticket`, onCompanyTicketNotificationsPopover);\n\t\t\t\tsocket.off(`company-${companyId}-appMessage`, onCompanyAppMessageNotificationsPopover);\n\t\t\t};\n\t\t}\n\t}, [user, profile, queues, showTicketWithoutQueue, socket, showNotificationPending, showGroupNotification]);\n\n\tconst handleNotifications = data => {\n\t\tconst { message, contact, ticket } = data;\n\n\t\tconst options = {\n\t\t\tbody: `${message.body} - ${format(new Date(), \"HH:mm\")}`,\n\t\t\ticon: contact.urlPicture,\n\t\t\ttag: ticket.id,\n\t\t\trenotify: true,\n\t\t};\n\t\tconst notification = new Notification(\n\t\t\t`${i18n.t(\"tickets.notification.message\")} ${contact.name}`,\n\t\t\toptions\n\t\t);\n\n\t\tnotification.onclick = e => {\n\t\t\te.preventDefault();\n\t\t\twindow.focus();\n\t\t\tsetTabOpen(ticket.status)\n\t\t\thistoryRef.current.push(`/tickets/${ticket.uuid}`);\n\t\t\t// handleChangeTab(null, ticket.isGroup? \"group\" : \"open\");\n\t\t};\n\n\t\tsetDesktopNotifications(prevState => {\n\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\tn => n.tag === notification.tag\n\t\t\t);\n\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\tprevState[notfiticationIndex] = notification;\n\t\t\t\treturn [...prevState];\n\t\t\t}\n\t\t\treturn [notification, ...prevState];\n\t\t});\n\t\tsoundAlertRef.current();\n\t};\n\n\tconst handleClick = () => {\n\t\tsetIsOpen(prevState => !prevState);\n\t};\n\n\tconst handleClickAway = () => {\n\t\tsetIsOpen(false);\n\t};\n\n\tconst NotificationTicket = ({ children }) => {\n\t\treturn <div onClick={handleClickAway}>{children}</div>;\n\t};\n\n\tconst browserNotification = () => {\n\t\tconst numbers = \"⓿➊➋➌➍➎➏➐➑➒➓⓫⓬⓭⓮⓯⓰⓱⓲⓳⓴\";\n\t\tif (notifications.length > 0) {\n\t\t\tif (notifications.length < 21) {\n\t\t\t\tdocument.title = numbers.substring(notifications.length, notifications.length + 1) + \" - \" + (theme.appName || \"...\");\n\t\t\t} else {\n\t\t\t\tdocument.title = \"(\" + notifications.length + \")\" + (theme.appName || \"...\");\n\t\t\t}\n\t\t} else {\n\t\t\tdocument.title = theme.appName || \"...\";\n\t\t}\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Favicon\n\t\t\t\t\tanimated={true}\n\t\t\t\t\turl={(theme?.appLogoFavicon) ? theme.appLogoFavicon : defaultLogoFavicon}\n\t\t\t\t\talertCount={notifications.length}\n\t\t\t\t\ticonSize={195}\n\t\t\t\t/>\n\t\t\t</>\n\t\t);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{browserNotification()}\n\n\t\t\t<IconButton\n\t\t\t\tonClick={handleClick}\n\t\t\t\tref={anchorEl}\n\t\t\t\taria-label=\"Open Notifications\"\n\t\t\t\tcolor=\"inherit\"\n\t\t\t\tstyle={{ color: \"white\" }}\n\t\t\t>\n\t\t\t\t<Badge overlap=\"rectangular\" badgeContent={notifications.length} color=\"secondary\">\n\t\t\t\t\t<ChatIcon />\n\t\t\t\t</Badge>\n\t\t\t</IconButton>\n\t\t\t<Popover\n\t\t\t\tdisableScrollLock\n\t\t\t\topen={isOpen}\n\t\t\t\tanchorEl={anchorEl.current}\n\t\t\t\tanchorOrigin={{\n\t\t\t\t\tvertical: \"bottom\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\ttransformOrigin={{\n\t\t\t\t\tvertical: \"top\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\tclasses={{ paper: classes.popoverPaper }}\n\t\t\t\tonClose={handleClickAway}\n\t\t\t>\n\t\t\t\t<List dense className={classes.tabContainer}>\n\t\t\t\t\t{notifications.length === 0 ? (\n\t\t\t\t\t\t<ListItem>\n\t\t\t\t\t\t\t<ListItemText>{i18n.t(\"notifications.noTickets\")}</ListItemText>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tnotifications.map(ticket => (\n\t\t\t\t\t\t\t<NotificationTicket key={ticket.id}>\n\t\t\t\t\t\t\t\t<TicketListItem ticket={ticket} />\n\t\t\t\t\t\t\t</NotificationTicket>\n\t\t\t\t\t\t))\n\t\t\t\t\t)}\n\t\t\t\t</List>\n\t\t\t</Popover>\n\t\t</>\n\t);\n};\n\nexport default NotificationsPopOver;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}