{"ast":null,"code":"var _jsxFileName = \"/workspaces/simao/whaticket/frontend/src/components/VersionControl/index.js\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport api from \"../../services/api\";\nimport Button from \"@material-ui/core/Button\";\nimport { useDate } from \"../../hooks/useDate\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nconst packageVersion = require(\"../../../package.json\").version;\nconst VersionControl = () => {\n  var _user$company, _user$company2;\n  const {\n    returnDays\n  } = useDate();\n  const {\n    user,\n    socket\n  } = useContext(AuthContext);\n  const [storedVersion] = useState(window.localStorage.getItem(\"version\") || \"0.0.0\");\n  const handleUpdateVersion = async () => {\n    window.localStorage.setItem(\"version\", packageVersion);\n\n    // Mantive apenas para salvar no banco a versao atual\n    const {\n      data\n    } = await api.post(\"/version\", {\n      version: packageVersion\n    });\n\n    // Limpar o cache do navegador\n    caches.keys().then(function (names) {\n      for (let name of names) caches.delete(name);\n    });\n\n    // Atraso para garantir que o cache foi limpo\n    setTimeout(() => {\n      window.location.reload(true); // Recarregar a página\n    }, 1000);\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    size: \"small\",\n    style: {\n      backgroundColor: \"red\",\n      color: \"white\",\n      fontWeight: \"bold\",\n      right: \"15px\"\n    },\n    onClick: handleUpdateVersion,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }\n  }, returnDays(user === null || user === void 0 ? void 0 : (_user$company = user.company) === null || _user$company === void 0 ? void 0 : _user$company.dueDate) === 0 ? `Sua licença vence hoje! Clique aqui para atualizar.` : `Sua licença vence em ${returnDays(user === null || user === void 0 ? void 0 : (_user$company2 = user.company) === null || _user$company2 === void 0 ? void 0 : _user$company2.dueDate)} dias! Clique aqui para atualizar.`));\n};\nexport default VersionControl;","map":{"version":3,"names":["React","useState","useContext","useEffect","api","Button","useDate","AuthContext","packageVersion","require","version","VersionControl","_user$company","_user$company2","returnDays","user","socket","storedVersion","window","localStorage","getItem","handleUpdateVersion","setItem","data","post","caches","keys","then","names","name","delete","setTimeout","location","reload","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","variant","size","style","backgroundColor","color","fontWeight","right","onClick","company","dueDate"],"sources":["/workspaces/simao/whaticket/frontend/src/components/VersionControl/index.js"],"sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport api from \"../../services/api\";\nimport Button from \"@material-ui/core/Button\";\nimport { useDate } from \"../../hooks/useDate\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst packageVersion = require(\"../../../package.json\").version;\n\nconst VersionControl = () => {\n  const { returnDays } = useDate();\n  const { user, socket } = useContext(AuthContext);\n  const [storedVersion] = useState(window.localStorage.getItem(\"version\") || \"0.0.0\");\n\n  const handleUpdateVersion = async () => {\n    window.localStorage.setItem(\"version\", packageVersion);\n\n    // Mantive apenas para salvar no banco a versao atual\n    const { data } = await api.post(\"/version\", {\n      version: packageVersion,\n    });\n\n    // Limpar o cache do navegador\n    caches.keys().then(function (names) {\n      for (let name of names) caches.delete(name);\n    });\n\n    // Atraso para garantir que o cache foi limpo\n    setTimeout(() => {\n      window.location.reload(true); // Recarregar a página\n    }, 1000);\n  };\n\n  return (\n   <div>\n      <Button\n       variant=\"contained\"\n         size=\"small\"\n          style={{\n            backgroundColor: \"red\",\n            color: \"white\",\n            fontWeight: \"bold\",\n            right: \"15px\",\n          }}\n          onClick={handleUpdateVersion}\n        >\n          {returnDays(user?.company?.dueDate) === 0 ? `Sua licença vence hoje! Clique aqui para atualizar.` : `Sua licença vence em ${returnDays(user?.company?.dueDate)} dias! Clique aqui para atualizar.`}\n        </Button>\n    {/*  {storedVersion !== packageVersion && (\n        <Button\n       variant=\"contained\"\n         size=\"small\"\n          style={{\n            backgroundColor: \"red\",\n            color: \"white\",\n            fontWeight: \"bold\",\n            right: \"15px\",\n          }}\n          onClick={handleUpdateVersion}\n        >\n          CLique aqui e atualize para nova versão.\n        </Button>\n     )} */}\n    </div> \n  );\n};\n\nexport default VersionControl;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,UAAU,EAAEC,SAAS,QAAQ,OAAO;AAC9D,OAAOC,GAAG,MAAM,oBAAoB;AACpC,OAAOC,MAAM,MAAM,0BAA0B;AAC7C,SAASC,OAAO,QAAQ,qBAAqB;AAC7C,SAASC,WAAW,QAAQ,gCAAgC;AAE5D,MAAMC,cAAc,GAAGC,OAAO,CAAC,uBAAuB,CAAC,CAACC,OAAO;AAE/D,MAAMC,cAAc,GAAGA,CAAA,KAAM;EAAA,IAAAC,aAAA,EAAAC,cAAA;EAC3B,MAAM;IAAEC;EAAW,CAAC,GAAGR,OAAO,CAAC,CAAC;EAChC,MAAM;IAAES,IAAI;IAAEC;EAAO,CAAC,GAAGd,UAAU,CAACK,WAAW,CAAC;EAChD,MAAM,CAACU,aAAa,CAAC,GAAGhB,QAAQ,CAACiB,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,IAAI,OAAO,CAAC;EAEnF,MAAMC,mBAAmB,GAAG,MAAAA,CAAA,KAAY;IACtCH,MAAM,CAACC,YAAY,CAACG,OAAO,CAAC,SAAS,EAAEd,cAAc,CAAC;;IAEtD;IACA,MAAM;MAAEe;IAAK,CAAC,GAAG,MAAMnB,GAAG,CAACoB,IAAI,CAAC,UAAU,EAAE;MAC1Cd,OAAO,EAAEF;IACX,CAAC,CAAC;;IAEF;IACAiB,MAAM,CAACC,IAAI,CAAC,CAAC,CAACC,IAAI,CAAC,UAAUC,KAAK,EAAE;MAClC,KAAK,IAAIC,IAAI,IAAID,KAAK,EAAEH,MAAM,CAACK,MAAM,CAACD,IAAI,CAAC;IAC7C,CAAC,CAAC;;IAEF;IACAE,UAAU,CAAC,MAAM;MACfb,MAAM,CAACc,QAAQ,CAACC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;IAChC,CAAC,EAAE,IAAI,CAAC;EACV,CAAC;EAED,oBACCjC,KAAA,CAAAkC,aAAA;IAAAC,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,gBACGxC,KAAA,CAAAkC,aAAA,CAAC7B,MAAM;IACNoC,OAAO,EAAC,WAAW;IACjBC,IAAI,EAAC,OAAO;IACXC,KAAK,EAAE;MACLC,eAAe,EAAE,KAAK;MACtBC,KAAK,EAAE,OAAO;MACdC,UAAU,EAAE,MAAM;MAClBC,KAAK,EAAE;IACT,CAAE;IACFC,OAAO,EAAE3B,mBAAoB;IAAAc,MAAA;IAAAC,QAAA;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAAA,GAE5B1B,UAAU,CAACC,IAAI,aAAJA,IAAI,wBAAAH,aAAA,GAAJG,IAAI,CAAEkC,OAAO,cAAArC,aAAA,uBAAbA,aAAA,CAAesC,OAAO,CAAC,KAAK,CAAC,GAAG,qDAAqD,GAAG,wBAAwBpC,UAAU,CAACC,IAAI,aAAJA,IAAI,wBAAAF,cAAA,GAAJE,IAAI,CAAEkC,OAAO,cAAApC,cAAA,uBAAbA,cAAA,CAAeqC,OAAO,CAAC,oCACxJ,CAgBP,CAAC;AAEV,CAAC;AAED,eAAevC,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module"}