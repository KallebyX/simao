{"ast":null,"code":"var _jsxFileName = \"/workspaces/simao/whaticket/frontend/src/components/QrcodeModal/index.js\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport QRCode from \"qrcode.react\";\nimport toastError from \"../../errors/toastError\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Dialog, DialogContent, Paper, Typography } from \"@material-ui/core\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\"\n  }\n}));\nconst QrcodeModal = ({\n  open,\n  onClose,\n  whatsAppId\n}) => {\n  const classes = useStyles();\n  const [qrCode, setQrCode] = useState(\"\");\n  const {\n    user,\n    socket\n  } = useContext(AuthContext);\n  useEffect(() => {\n    const fetchSession = async () => {\n      if (!whatsAppId) return;\n      try {\n        const {\n          data\n        } = await api.get(`/whatsapp/${whatsAppId}`);\n        setQrCode(data.qrcode);\n      } catch (err) {\n        toastError(err);\n      }\n    };\n    fetchSession();\n  }, [whatsAppId]);\n  useEffect(() => {\n    if (!whatsAppId) return;\n    const companyId = user.companyId;\n    // const socket = socketConnection({ companyId, userId: user.id });\n\n    const onWhatsappData = data => {\n      if (data.action === \"update\" && data.session.id === whatsAppId) {\n        setQrCode(data.session.qrcode);\n      }\n      if (data.action === \"update\" && data.session.qrcode === \"\") {\n        onClose();\n      }\n    };\n    socket.on(`company-${companyId}-whatsappSession`, onWhatsappData);\n    return () => {\n      socket.off(`company-${companyId}-whatsappSession`, onWhatsappData);\n    };\n  }, [whatsAppId, onClose]);\n  return /*#__PURE__*/React.createElement(Dialog, {\n    open: open,\n    onClose: onClose,\n    maxWidth: \"lg\",\n    scroll: \"paper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    elevation: 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    color: \"secondary\",\n    gutterBottom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }, i18n.t(\"qrCode.message\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, qrCode ? /*#__PURE__*/React.createElement(QRCode, {\n    value: qrCode,\n    size: 300,\n    style: {\n      backgroundColor: \"white\",\n      padding: '5px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 15\n    }\n  }, \"Aguardando pelo QR Code\")))));\n};\nexport default React.memo(QrcodeModal);","map":{"version":3,"names":["React","useEffect","useState","useContext","QRCode","toastError","makeStyles","Dialog","DialogContent","Paper","Typography","i18n","api","AuthContext","useStyles","theme","root","display","flexWrap","QrcodeModal","open","onClose","whatsAppId","classes","qrCode","setQrCode","user","socket","fetchSession","data","get","qrcode","err","companyId","onWhatsappData","action","session","id","on","off","createElement","maxWidth","scroll","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","elevation","color","gutterBottom","t","className","value","size","style","backgroundColor","padding","memo"],"sources":["/workspaces/simao/whaticket/frontend/src/components/QrcodeModal/index.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\";\nimport QRCode from \"qrcode.react\";\nimport toastError from \"../../errors/toastError\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Dialog, DialogContent, Paper, Typography } from \"@material-ui/core\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\n\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  },\n}))\n\nconst QrcodeModal = ({ open, onClose, whatsAppId }) => {\n  const classes = useStyles();\n  const [qrCode, setQrCode] = useState(\"\");\n  const { user, socket } = useContext(AuthContext);\n\n  useEffect(() => {\n    const fetchSession = async () => {\n      if (!whatsAppId) return;\n\n      try {\n        const { data } = await api.get(`/whatsapp/${whatsAppId}`);\n        setQrCode(data.qrcode);\n      } catch (err) {\n        toastError(err);\n      }\n    };\n    fetchSession();\n  }, [whatsAppId]);\n\n  useEffect(() => {\n    if (!whatsAppId) return;\n    const companyId = user.companyId;\n    // const socket = socketConnection({ companyId, userId: user.id });\n\n    const onWhatsappData = (data) => {\n      if (data.action === \"update\" && data.session.id === whatsAppId) {\n        setQrCode(data.session.qrcode);\n      }\n\n      if (data.action === \"update\" && data.session.qrcode === \"\") {\n        onClose();\n      }\n    }\n    socket.on(`company-${companyId}-whatsappSession`, onWhatsappData);\n\n    return () => {\n      socket.off(`company-${companyId}-whatsappSession`, onWhatsappData);\n    };\n  }, [whatsAppId, onClose]);\n\n  return (\n    <Dialog open={open} onClose={onClose} maxWidth=\"lg\" scroll=\"paper\">\n      <DialogContent>\n        <Paper elevation={0}>\n          <Typography color=\"secondary\" gutterBottom>\n            {i18n.t(\"qrCode.message\")}\n          </Typography>\n          <div className={classes.root}>\n            {qrCode ? (\n              <QRCode value={qrCode} size={300} style={{ backgroundColor: \"white\", padding: '5px' }} />\n            ) : (\n              <span>Aguardando pelo QR Code</span>\n            )}\n          </div>\n        </Paper>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default React.memo(QrcodeModal);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}